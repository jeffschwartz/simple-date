<!--
    Todo:
    1) Add a getter named 'isValid' and set it to boolean whenever the date is changed.
-->

<link rel="import" href="..\bower_components/polymer/polymer.html">
<script src="../javascript/datevalidation.js"></script>

<polymer-element name="simpledate-element" attributes="fontsize datecolor labelcolor yearcolor monthcolor daycolor separatorcolor year month day">
    <template>
        <style media="screen">
            input[type="text"] {
                text-align: right;
                font-size: {{fontsize}};
            }
            .pseudolabel {
                font-size: {{fontsize}};
                color: {{labelcolor || datecolor}};
            }
            .separator {
                font-size: {{fontsize}};
                color: {{separatorcolor}};
            }
            #date {
                width: 100%;
                color: {{datecolor}};
            }
            #date-element-year {
                width: 2.7em;
                color: {{yearcolor || datecolor}};
            }
            #date-element-month, #date-element-day {
                width: 1.7em;
            }
            #date-element-month {
                color: {{monthcolor || datecolor}};
            }
            #date-element-day {
                color: {{daycolor || datecolor}};
            }
        </style>
        <div id="date">
            <span class="pseudolabel">Date: </span>
            <span>
                <input id="date-element-year" type="text" name="txtYear" value="{{year}}" placeholder="yyyy" maxlength="4" autofocus>
                <strong class="separator">/</strong>
            </span>
            <span>
                <input id="date-element-month" type="text" name="txtMonth" value="{{month}}" placeholder="mm" maxlength="2">
                <strong class="separator">/</strong>
            </span>
            <span>
                <input id="date-element-day" type="text" name="txtDay" value="{{day}}" placeholder="dd" maxlength="2">
            </span>
        </div>
    </template>
        <script>
        (function(w){
            "use strict";
            var dv = w.ejr.dateValidation;
            Polymer({
                year: "",
                month: "",
                day: "",
                isValid: false,
                observe: {
                    year: "isDateValid",
                    month: "isDateValid",
                    day: "isDateValid"
                },
                // Returns true if date is valid, otherwise returns false.
                isDateValid: function() {
                     this.isValid = dv.isDateValid(parseInt(this.year, 10), parseInt(this.month, 10), parseInt(this.day, 10));
                     console.log("isDateValid =", this.isValid);
                     if(this.isValid){
                         console.log("new Date =", this.getDate());
                         console.log("date as string =", this.getDateAsString());
                     }
                },
                // Create and returns a Date object if the date is valid, otherwise returns undefined.
                getDate: function() {
                    return this.isValid && new Date(parseInt(this.year), parseInt(this.month - 1), parseInt(this.day)) || void(0);
                },
                // Returns a Date as a string if the date is valid, otherwise returns undefined.
                getDateAsString: function() {
                    return this.isValid && Date(parseInt(this.year), parseInt(this.month - 1), parseInt(this.day)) || void(0);
                }
            });
        }(window));
        </script>
</polymer-element>
